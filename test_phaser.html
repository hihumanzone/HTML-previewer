<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phaser.js Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #2c2c2c;
            color: white;
            font-family: Arial, sans-serif;
        }
        #game-container {
            border: 2px solid #555;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Phaser.js Asset Loading Test</h1>
    <div id="game-container"></div>
    
    <script src="phaser.js"></script>
    <script>
        class PreloaderScene extends Phaser.Scene {
            constructor() {
                super('PreloaderScene');
            }
            
            preload() {
                const { width, height } = this.cameras.main;
                
                const progressBox = this.add.graphics();
                progressBox.fillStyle(0x222222, 0.8);
                progressBox.fillRect(width / 2 - 160, height / 2 - 25, 320, 50);
                
                const progressBar = this.add.graphics();
                const loadingText = this.make.text({
                    x: width / 2,
                    y: height / 2 - 50,
                    text: 'Loading...',
                    style: { font: '20px monospace', fill: '#ffffff' }
                }).setOrigin(0.5);
                
                this.load.on('progress', (value) => {
                    progressBar.clear();
                    progressBar.fillStyle(0xffffff, 1);
                    progressBar.fillRect(width / 2 - 150, height / 2 - 15, 300 * value, 30);
                });
                
                this.load.on('complete', () => {
                    progressBar.destroy();
                    progressBox.destroy();
                    loadingText.destroy();
                });
                
                this.load.on('loaderror', (file) => {
                    console.error('Failed to load:', file.key, file.src);
                });
                
                this.load.on('filecomplete', (key, type, data) => {
                    console.log('File loaded:', key, type);
                });
                this.load.image('mainMenu', 'assets/main_menu.png');
                this.load.image('mainBanner', 'assets/main_banner.png');
                this.load.image('playButton', 'assets/play_button.png');
                this.load.image('myRoom', 'assets/my_room.png');
                this.load.image('garden', 'assets/garden.png');
                
                this.load.spritesheet('jack', 'assets/jack.png', { frameWidth: 64, frameHeight: 64 });
                
                this.load.audio('menuMusic', ['assets/music/menu.mp3']);
                this.load.audio('roomMusic', ['assets/music/room.mp3']);
                this.load.audio('gardenMusic', ['assets/music/garden.mp3']);
                
                this.load.audio('button', ['assets/sfx/button.mp3']);
                this.load.audio('door', ['assets/sfx/door.mp3']);
                this.load.audio('walking', ['assets/sfx/walking.mp3']);
            }
            
            create() {
                this.scene.start('MainMenuScene');
            }
        }
        
        class MainMenuScene extends Phaser.Scene {
            constructor() {
                super('MainMenuScene');
            }
            
            create() {
                const { width, height } = this.cameras.main;
                
                this.add.rectangle(width / 2, height / 2, width, height, 0x1a1a2e);
                
                this.add.image(width / 2, 100, 'mainBanner').setScale(0.5);
                this.add.image(width / 2, height / 2, 'mainMenu').setScale(0.7);
                
                const playBtn = this.add.image(width / 2, height / 2 + 100, 'playButton')
                    .setScale(0.6)
                    .setInteractive()
                    .on('pointerdown', () => {
                        this.sound.play('button');
                        this.scene.start('GameScene');
                    });
                
                const jack = this.add.sprite(100, height / 2, 'jack', 0).setScale(2);
                this.anims.create({
                    key: 'jack_idle',
                    frames: this.anims.generateFrameNumbers('jack', { start: 0, end: 3 }),
                    frameRate: 4,
                    repeat: -1
                });
                jack.play('jack_idle');
                
                this.sound.play('menuMusic', { loop: true, volume: 0.5 });
            }
        }
        
        class GameScene extends Phaser.Scene {
            constructor() {
                super('GameScene');
            }
            
            create() {
                const { width, height } = this.cameras.main;
                
                this.add.rectangle(width / 2, height / 2, width, height, 0x0f4c75);
                this.add.image(width / 2, height / 2, 'myRoom').setScale(0.8);
                
                this.add.text(width / 2, 50, 'Game Scene - Assets Loaded Successfully!', {
                    fontSize: '24px',
                    fill: '#ffffff'
                }).setOrigin(0.5);
                
                this.sound.stopAll();
                this.sound.play('roomMusic', { loop: true, volume: 0.5 });
            }
        }
        
        // Game configuration
        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            parent: 'game-container',
            backgroundColor: '#2c2c2c',
            scene: [PreloaderScene, MainMenuScene, GameScene],
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 0 },
                    debug: false
                }
            }
        };
        
        const game = new Phaser.Game(config);
    </script>
</body>
</html>